<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Combine Spectra — combineSpectra,MSnExp-method • MSnbase</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Combine Spectra — combineSpectra,MSnExp-method" />

<meta property="og:description" content="combineSpectra combines spectra in a MSnExp, OnDiskMSnExp
or Spectra object applying the summarization function fun to sets
of spectra defined by a factor (fcol parameter). The resulting combined
spectrum for each set contains metadata information (present in mcols and
all spectrum information other than mz and intensity) from the first
spectrum in each set.
Combining of spectra for MSnExp or OnDiskMSnExp objects is
performed by default for each file separately, combining of spectra
across files is thus not possible. See examples for details." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MSnbase</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.11.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v01-MSnbase-demo.html">MSnbase: MS data processing, visualisation and quantification</a>
    </li>
    <li>
      <a href="../articles/v02-MSnbase-io.html">MSnbase IO capabilities</a>
    </li>
    <li>
      <a href="../articles/v03-MSnbase-centroiding.html">MSnbase: centroiding of profile-mode MS data</a>
    </li>
    <li>
      <a href="../articles/v04-benchmarking.html">MSnbase benchmarking</a>
    </li>
    <li>
      <a href="../articles/v05-MSnbase-development.html">A short introduction to *MSnbase* development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Combine Spectra</h1>
    
    <div class="hidden name"><code>combineSpectra.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>combineSpectra</code> combines spectra in a <a href='MSnExp-class.html'>MSnExp</a>, <a href='OnDiskMSnExp-class.html'>OnDiskMSnExp</a>
or <a href='Spectra.html'>Spectra</a> object applying the summarization function <code>fun</code> to sets
of spectra defined by a factor (<code>fcol</code> parameter). The resulting combined
spectrum for each set contains metadata information (present in <code>mcols</code> and
all spectrum information other than <code>mz</code> and <code>intensity</code>) from the <strong>first</strong>
spectrum in each set.</p>
<p>Combining of spectra for <a href='MSnExp-class.html'>MSnExp</a> or <a href='OnDiskMSnExp-class.html'>OnDiskMSnExp</a> objects is
performed by default for each file <strong>separately</strong>, combining of spectra
across files is thus not possible. See examples for details.</p>
    
    </div>

    <pre class="usage"><span class='co'># S4 method for MSnExp</span>
<span class='fu'>combineSpectra</span>(<span class='no'>object</span>, <span class='kw'>fcol</span> <span class='kw'>=</span> <span class='st'>"fileIdx"</span>,
  <span class='kw'>method</span> <span class='kw'>=</span> <span class='no'>meanMzInts</span>, <span class='no'>...</span>, <span class='kw'>BPPARAM</span> <span class='kw'>=</span> <span class='fu'>bpparam</span>())

<span class='co'># S4 method for Spectra</span>
<span class='fu'>combineSpectra</span>(<span class='no'>object</span>, <span class='no'>fcol</span>, <span class='kw'>method</span> <span class='kw'>=</span> <span class='no'>meanMzInts</span>,
  <span class='no'>fun</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <a href='MSnExp-class.html'>MSnExp</a> or <a href='Spectra.html'>Spectra</a></p></td>
    </tr>
    <tr>
      <th>fcol</th>
      <td><p>For <code>Spectra</code> objects: <code>mcols</code> column name to be used to define
the sets of spectra to be combined. If missing, all spectra are
considered to be one set. For <code>MSnExp</code>/<code>OnDiskMSnExp</code> objects: column
in <code>fData(object)</code> defining which spectra to combine. See examples below
for more details.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p><code>function</code> to be used to combine the spectra by <code>fcol</code>. Has to
be a function that takes a list of spectra as input and returns a single
<a href='Spectrum-class.html'>Spectrum</a>. See <code><a href='meanMzInts.html'>meanMzInts()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments for <code>fun</code>.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>For <code>MSnExp</code>/<code>OnDiskMSnExp</code> objects: parallel processing setup
to perform per-file parallel spectra combining. See <code>bpparam()</code> for more
details.</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p><em>Deprecated</em> use <code>method</code> instead.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code>Spectra</code> or <code>MSnExp</code> object with combined spectra. Metadata
(<code>mcols</code>) and all spectrum attributes other than <code>mz</code> and <code>intensity</code>
are taken from the first <code>Spectrum</code> in each set.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='meanMzInts.html'>meanMzInts()</a></code> for a function to combine spectra.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>123</span>)
<span class='no'>mzs</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>1</span>, <span class='fl'>20</span>, <span class='fl'>0.1</span>)
<span class='no'>ints1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='fl'>10</span>))
<span class='no'>ints1</span>[<span class='fl'>11</span>:<span class='fl'>20</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>15</span>, <span class='fl'>30</span>, <span class='fl'>90</span>, <span class='fl'>200</span>, <span class='fl'>500</span>, <span class='fl'>300</span>, <span class='fl'>100</span>, <span class='fl'>70</span>, <span class='fl'>40</span>, <span class='fl'>20</span>) <span class='co'># add peak</span>
<span class='no'>ints2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='fl'>10</span>))
<span class='no'>ints2</span>[<span class='fl'>11</span>:<span class='fl'>20</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>15</span>, <span class='fl'>30</span>, <span class='fl'>60</span>, <span class='fl'>120</span>, <span class='fl'>300</span>, <span class='fl'>200</span>, <span class='fl'>90</span>, <span class='fl'>60</span>, <span class='fl'>30</span>, <span class='fl'>23</span>)
<span class='no'>ints3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='fl'>10</span>))
<span class='no'>ints3</span>[<span class='fl'>11</span>:<span class='fl'>20</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>13</span>, <span class='fl'>20</span>, <span class='fl'>50</span>, <span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>100</span>, <span class='fl'>80</span>, <span class='fl'>40</span>, <span class='fl'>30</span>, <span class='fl'>20</span>)

<span class='co'>## Create the spectra.</span>
<span class='no'>sp1</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"Spectrum1"</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzs</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.01</span>),
    <span class='kw'>intensity</span> <span class='kw'>=</span> <span class='no'>ints1</span>, <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fl'>1</span>)
<span class='no'>sp2</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"Spectrum1"</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzs</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.01</span>),
    <span class='kw'>intensity</span> <span class='kw'>=</span> <span class='no'>ints2</span>, <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>sp3</span> <span class='kw'>&lt;-</span> <span class='fu'>new</span>(<span class='st'>"Spectrum1"</span>, <span class='kw'>mz</span> <span class='kw'>=</span> <span class='no'>mzs</span> + <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span>(<span class='fu'><a href='pSet-class.html'>length</a></span>(<span class='no'>mzs</span>), <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>0.009</span>),
    <span class='kw'>intensity</span> <span class='kw'>=</span> <span class='no'>ints3</span>, <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fl'>3</span>)

<span class='no'>spctra</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Spectra.html'>Spectra</a></span>(<span class='no'>sp1</span>, <span class='no'>sp2</span>, <span class='no'>sp3</span>,
    <span class='kw'>elementMetadata</span> <span class='kw'>=</span> <span class='fu'>DataFrame</span>(<span class='kw'>idx</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>3</span>, <span class='kw'>group</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"b"</span>, <span class='st'>"a"</span>, <span class='st'>"a"</span>)))

<span class='co'>## Combine the spectra reporting the maximym signal</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>combineSpectra</span>(<span class='no'>spctra</span>, <span class='kw'>mzd</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>intensityFun</span> <span class='kw'>=</span> <span class='no'>max</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; Spectra with 1 spectra and 2 metadata column(s):
#&gt;       msLevel     rtime peaksCount |       idx       group
#&gt;     &lt;integer&gt; &lt;numeric&gt;  &lt;integer&gt; | &lt;integer&gt; &lt;character&gt;
#&gt;   1         1         1        191 |         1           b</div><div class='input'>
<span class='co'>## All values other than m/z and intensity are kept from the first spectrum</span>
<span class='fu'><a href='Spectrum-class.html'>rtime</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; 1 
#&gt; 1 </div><div class='input'>
<span class='co'>## Plot the individual and the merged spectrum</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>1</span>), <span class='kw'>mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4.3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>1</span>))
<span class='fu'><a href='plot-methods.html'>plot</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp1</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp1</span>), <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>mzs</span>[<span class='fl'>5</span>:<span class='fl'>25</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp2</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp2</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp3</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp3</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>)
<span class='fu'><a href='plot-methods.html'>plot</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>,
    <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"black"</span>, <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>mzs</span>[<span class='fl'>5</span>:<span class='fl'>25</span>]))</div><div class='img'><img src='combineSpectra-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Combine spectra in two sets.</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>combineSpectra</span>(<span class='no'>spctra</span>, <span class='kw'>fcol</span> <span class='kw'>=</span> <span class='st'>"group"</span>, <span class='kw'>mzd</span> <span class='kw'>=</span> <span class='fl'>0.05</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; Spectra with 2 spectra and 2 metadata column(s):
#&gt;       msLevel     rtime peaksCount |       idx       group
#&gt;     &lt;integer&gt; &lt;numeric&gt;  &lt;integer&gt; | &lt;integer&gt; &lt;character&gt;
#&gt;   1         1         1        191 |         1           b
#&gt;   2         1         2        191 |         2           a</div><div class='input'>
<span class='fu'><a href='Spectrum-class.html'>rtime</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; 1 2 
#&gt; 1 2 </div><div class='input'>
<span class='co'>## Plot the individual and the merged spectra</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>1</span>), <span class='kw'>mar</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>4.3</span>, <span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>1</span>))
<span class='fu'><a href='plot-methods.html'>plot</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp1</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp1</span>), <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>mzs</span>[<span class='fl'>5</span>:<span class='fl'>25</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"red"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp2</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp2</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"green"</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>sp3</span>), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>sp3</span>), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>, <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"blue"</span>)
<span class='fu'><a href='plot-methods.html'>plot</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>1</span>]]), <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>mzs</span>[<span class='fl'>5</span>:<span class='fl'>25</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>,
    <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"black"</span>)
<span class='fu'><a href='plot-methods.html'>plot</a></span>(<span class='fu'><a href='Spectrum-class.html'>mz</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>2</span>]]), <span class='fu'><a href='Spectrum-class.html'>intensity</a></span>(<span class='no'>res</span><span class='kw'>[[</span><span class='fl'>2</span>]]), <span class='kw'>xlim</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>mzs</span>[<span class='fl'>5</span>:<span class='fl'>25</span>]), <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"h"</span>,
    <span class='kw'>col</span> <span class='kw'>=</span> <span class='st'>"black"</span>)</div><div class='img'><img src='combineSpectra-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Combining spectra of an MSnExp/OnDiskMSnExp objects</span>
<span class='co'>## Reading data from 2 mzML files</span>
<span class='no'>sciex</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='readMSData.html'>readMSData</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>dir</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"sciex"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"msdata"</span>),
    <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='kw'>mode</span> <span class='kw'>=</span> <span class='st'>"onDisk"</span>)

<span class='co'>## Filter the file to a retention time range from 2 to 20 seconds (to reduce</span>
<span class='co'>## execution time of the example)</span>
<span class='no'>sciex</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='MSnExp-class.html'>filterRt</a></span>(<span class='no'>sciex</span>, <span class='kw'>rt</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>20</span>))
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='fu'><a href='Spectrum-class.html'>fromFile</a></span>(<span class='no'>sciex</span>))</div><div class='output co'>#&gt; 
#&gt;  1  2 
#&gt; 64 64 </div><div class='input'>
<span class='co'>## We have thus 64 spectra per file.</span>

<span class='co'>## In the example below we combine spectra measured in one second to a</span>
<span class='co'>## single spectrum. We thus first define the grouping variable and add that</span>
<span class='co'>## to the `fData` of the object. For combining, we use the</span>
<span class='co'>## `consensusSpectrum` function that combines the spectra keeping only peaks</span>
<span class='co'>## that were found in 50% of the spectra; by defining `mzd = 0.01` all peaks</span>
<span class='co'>## within an m/z of 0.01 are evaluated for combining.</span>
<span class='no'>seconds</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span>(<span class='fu'><a href='Spectrum-class.html'>rtime</a></span>(<span class='no'>sciex</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>seconds</span>)</div><div class='output co'>#&gt; F1.S008 F1.S009 F1.S010 F1.S011 F1.S012 F1.S013 
#&gt;       2       3       3       3       3       4 </div><div class='input'><span class='fu'>fData</span>(<span class='no'>sciex</span>)$<span class='no'>second</span> <span class='kw'>&lt;-</span> <span class='no'>seconds</span>

<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>combineSpectra</span>(<span class='no'>sciex</span>, <span class='kw'>fcol</span> <span class='kw'>=</span> <span class='st'>"second"</span>, <span class='kw'>mzd</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>minProp</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
    <span class='kw'>method</span> <span class='kw'>=</span> <span class='no'>consensusSpectrum</span>)
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='fu'><a href='Spectrum-class.html'>fromFile</a></span>(<span class='no'>res</span>))</div><div class='output co'>#&gt; 
#&gt;  1  2 
#&gt; 19 19 </div><div class='input'>
## The data was reduced to 19 spectra for each file.
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Johannes Rainer, Laurent Gatto</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


